<?xml version="1.0" encoding="utf-8"?>
<ContentPage xmlns="http://xamarin.com/schemas/2014/forms"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:local="clr-namespace:Proyecto.Controls"
               xmlns:controls="clr-namespace:Proyecto.Controls"
  xmlns:d="http://xamarin.com/schemas/2014/forms/design"
             xmlns:viewModels="clr-namespace:Proyecto.ViewModels"
             x:Class="Proyecto.Views.SpacesPage"
             NavigationPage.HasNavigationBar="False"
             BackgroundColor="White">
    <!-- Definir recursos y conversores -->
    <ContentPage.Resources>
        <ResourceDictionary>
            <!-- Conversor de ocupación a color -->
            <local:OccupiedColorConverter x:Key="OccupiedToColorConverter" />
        </ResourceDictionary>
    </ContentPage.Resources>
    <!-- Binding del ViewModel -->
    <ContentPage.BindingContext>
        <viewModels:ParkingSpacesViewModel />
    </ContentPage.BindingContext>
    <Grid>
        <StackLayout>
            <!-- Título -->
            <Label Text="Aparcamiento 😍"
                   FontSize="35"
                   HorizontalOptions="Center"
                   Margin="0,30"
                   FontAttributes="Bold"
                   TextColor="Black" />
            <!-- Encabezado del bloque A -->
            <Label Text="Bloque A:"
                   FontSize="25"
                   HorizontalOptions="Start"
                   Margin="20,20"
                   TextColor="Black"
                   TextDecorations="Underline" />
            <!-- Grid de espacios de aparcamiento -->
            <Grid Margin="20,0">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <!-- Espacios de aparcamiento -->
                <Button Text="{Binding ParkingSpaces[0].SpaceNumber}"
                        BackgroundColor="{Binding ParkingSpaces[0].IsOccupied, Converter={StaticResource OccupiedToColorConverter}}"
                        TextColor="White"
                        FontSize="12"
                        FontAttributes="Bold"
                        Command="{Binding CheckAndNavigateCommand}"
                        CommandParameter="{Binding ParkingSpaces[0]}"
                        Grid.Row="0"
                        Grid.Column="0"
                        VerticalOptions="FillAndExpand"
                        Margin="10,0"
                        CornerRadius="12"
                        HeightRequest="70" />
                <Button Text="{Binding ParkingSpaces[1].SpaceNumber}"
                        BackgroundColor="{Binding ParkingSpaces[1].IsOccupied, Converter={StaticResource OccupiedToColorConverter}}"
                        TextColor="White"
                        FontSize="12"
                        FontAttributes="Bold"
                        Command="{Binding CheckAndNavigateCommand}"
                        CommandParameter="{Binding ParkingSpaces[1]}"
                        Grid.Row="0"
                        Grid.Column="1"
                        VerticalOptions="FillAndExpand"
                        Margin="10,0"
                        CornerRadius="12"
                        HeightRequest="70" />
                <Button Text="{Binding ParkingSpaces[2].SpaceNumber}"
                        BackgroundColor="{Binding ParkingSpaces[2].IsOccupied, Converter={StaticResource OccupiedToColorConverter}}"
                        TextColor="White"
                        FontSize="12"
                        FontAttributes="Bold"
                        Command="{Binding CheckAndNavigateCommand}"
                        CommandParameter="{Binding ParkingSpaces[2]}"
                        Grid.Row="1"
                        Grid.Column="0"
                        VerticalOptions="FillAndExpand"
                        Margin="10,10"
                        CornerRadius="12"
                        HeightRequest="70" />
                <Button Text="{Binding ParkingSpaces[3].SpaceNumber}"
                        BackgroundColor="{Binding ParkingSpaces[3].IsOccupied, Converter={StaticResource OccupiedToColorConverter}}"
                        TextColor="White"
                        FontSize="12"
                        FontAttributes="Bold"
                        Command="{Binding CheckAndNavigateCommand}"
                        CommandParameter="{Binding ParkingSpaces[3]}"
                        Grid.Row="1"
                        Grid.Column="1"
                        VerticalOptions="FillAndExpand"
                        Margin="10,10"
                        CornerRadius="12"
                        HeightRequest="70" />
                <Button Text="{Binding ParkingSpaces[4].SpaceNumber}"
                        BackgroundColor="{Binding ParkingSpaces[4].IsOccupied, Converter={StaticResource OccupiedToColorConverter}}"
                        TextColor="White"
                        FontSize="12"
                        FontAttributes="Bold"
                        Command="{Binding CheckAndNavigateCommand}"
                        CommandParameter="{Binding ParkingSpaces[4]}"
                        Grid.Row="2"
                        Grid.Column="0"
                        VerticalOptions="FillAndExpand"
                        Margin="10,10"
                        CornerRadius="12"
                        HeightRequest="70" />
                <Button Text="{Binding ParkingSpaces[5].SpaceNumber}"
                        BackgroundColor="{Binding ParkingSpaces[5].IsOccupied, Converter={StaticResource OccupiedToColorConverter}}"
                        TextColor="White"
                        FontSize="12"
                        FontAttributes="Bold"
                        Command="{Binding CheckAndNavigateCommand}"
                        CommandParameter="{Binding ParkingSpaces[5]}"
                        Grid.Row="2"
                        Grid.Column="1"
                        VerticalOptions="FillAndExpand"
                        Margin="10,10"
                        CornerRadius="12"
                        HeightRequest="70" />
                <Button Text="{Binding ParkingSpaces[6].SpaceNumber}"
                        BackgroundColor="{Binding ParkingSpaces[6].IsOccupied, Converter={StaticResource OccupiedToColorConverter}}"
                        TextColor="White"
                        FontSize="12"
                        FontAttributes="Bold"
                        Command="{Binding CheckAndNavigateCommand}"
                        CommandParameter="{Binding ParkingSpaces[6]}"
                        Grid.Row="3"
                        Grid.Column="0"
                        VerticalOptions="FillAndExpand"
                        Margin="10,10"
                        CornerRadius="12"
                        HeightRequest="70" />
                <Button Text="{Binding ParkingSpaces[7].SpaceNumber}"
                        BackgroundColor="{Binding ParkingSpaces[7].IsOccupied, Converter={StaticResource OccupiedToColorConverter}}"
                        TextColor="White"
                        FontSize="12"
                        FontAttributes="Bold"
                        Command="{Binding CheckAndNavigateCommand}"
                        CommandParameter="{Binding ParkingSpaces[7]}"
                        Grid.Row="3"
                        Grid.Column="1"
                        VerticalOptions="FillAndExpand"
                        Margin="10,10"
                        CornerRadius="12"
                        HeightRequest="70" />
            </Grid>

        </StackLayout>
        <controls:CustomNavbar Grid.Row="1"
       VerticalOptions="End"
       HorizontalOptions="FillAndExpand"
       Padding="0"
       Margin="0" />
    </Grid>

</ContentPage>